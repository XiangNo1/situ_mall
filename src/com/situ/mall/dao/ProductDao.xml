<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.situ.mall.dao.ProductDao">


	<select id="findCategoryById" parameterType="Integer" resultType="Category">
		select * from category where id=#{id}
	</select>

	<update id="upProductById" parameterType="Integer">
		update product set status=1 where id=#{id}
	</update>
	
	<update id="downProductById" parameterType="Integer">
		update product set status=2 where id=#{id}
	</update>

	<select id="selectSecond" parameterType="Integer" resultType="Category">
		select * from category where parent_id=#{id}
	</select>

	<select id="selectFirst" resultType="Category">
		select * from category where parent_id=0
	</select>

	<select id="findSearchProductBeanList" resultType="Product">
		select * from product
		<where>
       <if test="searchCondition.product.category_id != null">
           and category_id=#{searchCondition.product.category_id}
       </if>
       </where>
		limit #{index},#{searchCondition.pageSize}
	</select>

	<select id="findTotalCountSearchProduct" parameterType="SearchProductByCondition" resultType="Integer">
		select count(*) from product 
		<where>
       <if test="product.category_id != null">
           and category_id=#{product.category_id}
       </if>
       </where>
	</select>

	<update id="updateStatusProduct">
		update product set status=#{status} where id=#{id}
	</update>

	<update id="updateProduct" parameterType="Product">
		update product set category_id=#{category_id},name=#{name},price=#{price},main_image=#{main_image},stock=#{stock},status=#{status},update_time=now() where id=#{id}
	</update>

	<select id="findProductById" parameterType="Integer" resultType="Product">
		select * from product where id=#{id}
	</select>

	<select id="findTotalCountProduct" resultType="Integer">
		select count(*) from product
	</select>
	
	<select id="findProductBeanList" resultType="Product">
		select * from product limit #{index},#{pageSize}
	</select>
	
	<insert id="addProduct" parameterType="Product">
		insert into product(id,category_id,name,main_image,sub_images,detail,price,stock,status,create_time,update_time)
		 values(#{id},#{category_id},#{name},#{main_image},#{sub_images},#{detail},#{price},#{stock},#{status},now(),now())
	</insert>
	
	<delete id="deleteProductById" parameterType="Integer">
		delete from product where id=#{id}
	</delete>
</mapper>